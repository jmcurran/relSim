maximizeLRPC = function(N, Freqs, BlockSize = N/10){

    f = unlist(Freqs$freqs)
    n =  cumsum(c(0,sapply(fbiCaucs$freqs,length)))
    n = n[-length(n)] ## cummulative offsets since
                      ## we need to jump randomly about
    nLoci = length(Freqs$loci)


    P1 = randomProfile(fbiCaucs)
    P2 = randomProfile(fbiCaucs)
    lrMax = lrPC(P1, P2, fbiCaucs)

    nBlocks = N/BlockSize

    pb = txtProgressBar(min = 0, max = nBlocks, style = 3)

    for(block in 1:nBlocks){
        res = .C("maximizeLRPC", P1 = as.integer(P1), P2 = as.integer(P2),
                 f = as.double(f), n = as.integer(n), u = runif(5*BlockSize),
                 bs = as.integer(BlockSize), lrMax = as.double(lrMax))

        P1 = res$P1
        P2 = res$P2
        lrMax = res$lrMax

        setTxtProgressBar(pb, block)
    }

    return(list(P1 = P1, P2 = P2, lrMax = lrMax))
}
